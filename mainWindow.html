<!DOCTYPE html>
<html lang="en">
<head>
    <title>ShutdownApp</title>
</head>
<body>
    <h1>ShutdownApp</h1>
    <h2>Pozosta≈Ço sekund: <span id="countdown"></span></h2>
    <input type="number" id="timeValueInput" style="width: 50px">
    <select name="time-select" id="timeSelect">
        <option value="minutes">minuty</option>
        <option value="seconds">sekundy</option>
    </select>
    <button id="start">Zacznij</button>
    <button id="abort">Przerwij</button>

    <script>
        'use strict';
        const electron = require('electron');
        const {ipcRenderer} = electron;

        let myInterval;
        
        const startCountdown = (secondsOrHours, timeValueInput) => {
            let currentSecondsLeft;
            if (secondsOrHours === 'minutes') {
                currentSecondsLeft = timeValueInput * 60;
            } else {
                currentSecondsLeft = timeValueInput;
            }
            myInterval = setInterval(() => {
                if (currentSecondsLeft === 0) {
                    updateTimer(currentSecondsLeft);
                    clearInterval(myInterval);
                    sendEvent();
                } else {
                    updateTimer(currentSecondsLeft);
                    currentSecondsLeft --;
                }
            }, 1000);
        };

        const abortCountdown = () => {
            clearInterval(myInterval);
        }

        const updateTimer = (currentSecondsLeft) => {
            const span = document.getElementById('countdown');
            span.innerHTML = currentSecondsLeft;
        }

        const sendEvent = () => {
            ipcRenderer.send('start');
        }

        const startButton = document.getElementById('start');
        startButton.addEventListener('click', (e) => {
            e.preventDefault();
            const item = startButton.innerText;
            const secondsOrHours = document.getElementById('timeSelect').value;
            const timeValueInput = document.getElementById('timeValueInput').value;
            startCountdown(secondsOrHours, timeValueInput);
        });

        const abortButton = document.getElementById('abort');
        abortButton.addEventListener('click', (e) => {
            e.preventDefault();
            const item = startButton.innerText;
            abortCountdown();
        });

    </script>
</body>
</html>